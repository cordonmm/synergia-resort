<?phpclass WelcomeController extends BaseController {       /**     * User Model     * @var User     */    protected $user;    /**     * Inject the models.     * @param User $user     */    public function __construct(User $user)    {        parent::__construct();        $this->user = $user;    }    	/**	 * Returns all the blog posts.	 *	 * @return View	 */	public function getIndex()    {    $hoy = date('y-m-d');    $fechafin = strtotime ( '+2 year' , strtotime ( $hoy ) ) ;    $fechafin = date ( 'y-m-d' , $fechafin );    $ch = curl_init("https://api.airbnb.com/v1/authorize");    curl_setopt($ch, CURLOPT_POST,true);    curl_setopt($ch, CURLOPT_POSTFIELDS, "client_id=3092nxybyb0otqw18e8nh5nty&locale=es-ES&currency=EUR&grant_type=password&password=alojamiento16&username=cristina@synergia.es");    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);    curl_setopt($ch,CURLOPT_RETURNTRANSFER,true);    $response = curl_exec($ch);    curl_close($ch);    $access = json_decode($response,true);    if($access != null and array_key_exists("access_token",$access)) {        $url = "https://api.airbnb.com/v2/batch/?client_id=3092nxybyb0otqw18e8nh5nty&locale=es-ES&currency=EUR";        $data_json = '{"operations":[{"method":"GET","path":"/calendar_days","query":{"start_date":"'.$hoy.'","listing_id":"12878755","_format":"host_calendar","end_date":"'.$fechafin.'"}},{"method":"GET","path":"/dynamic_pricing_controls/12878755","query":{}}],"_transaction":false}';        $ch = curl_init($url);        curl_setopt($ch, CURLOPT_HTTPHEADER, array('X-Airbnb-OAuth-Token: '.$access["access_token"],'Content-Type: application/json; charset=UTF-8','Content-Length: ' . strlen($data_json)));        curl_setopt($ch, CURLOPT_POST, true);        curl_setopt($ch, CURLOPT_POSTFIELDS,$data_json);        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);        $response  = curl_exec($ch);        curl_close($ch);        $calendar_days = json_decode($response,true)["operations"][0]["response"]["calendar_days"];        $unavailable = array();        foreach($calendar_days as $dia){            if(!$dia["available"]){                array_push($unavailable,$dia["date"]);            }        }    }else{        return View::make('site/notservice');    }    JavaScript::put([        'unavailable' => $unavailable,    ]);    return View::make('site/welcome');	}	}